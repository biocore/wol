<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>WebGL - Experiment</title>
  <link rel="stylesheet" type="text/css" href="pages/empress/vendor/css/slick.grid.css">
  <link rel="stylesheet" type="text/css" href="pages/empress/vendor/css/jquery-ui-1.11.3.custom.css">
  <link rel="stylesheet" type="text/css" href="pages/empress/vendor/css/slick.grid.format.css">
  <link rel="stylesheet" type="text/css" href="pages/empress/css/tree.css">
  <script type="text/javascript" src="pages/empress/vendor/js/gl-matrix.min.js"></script>
  <script type="text/javascript" src="pages/empress/vendor/js/jquery-2.2.4.min.js"></script>
  <script type="text/javascript" src="pages/empress/vendor/js/jquery.event.drag-2.2.min.js"></script>
  <script type="text/javascript" src="pages/empress/js/init_webgl.js"></script>
  <script type="text/javascript" src="pages/empress/js/initialize_empress.js"></script>
  <script type="text/javascript" src="pages/empress/js/mouse_events.js"></script>
  <script type="text/javascript" src="pages/empress/js/callbacks.js"></script>
  <script type="text/javascript" src="pages/empress/js/drawing_loop.js"></script>
  <script type="text/javascript" src="pages/empress/js/init_webpage.js"></script>
  <script type="text/javascript" src="pages/empress/vendor/js/slick.core.min.js"></script>
  <script type="text/javascript" src="pages/empress/vendor/js/slick.editors.min.js"></script>
  <script type="text/javascript" src="pages/empress/vendor/js/slick.formatters.min.js"></script>
  <script type="text/javascript" src="pages/empress/vendor/js/slick.grid.min.js"></script>
  <script type="text/javascript" src="pages/empress/js/wol_tree.js"></script>
  <script type="text/javascript" src="pages/empress/vendor/js/parse.js"></script>
  <script type="text/javascript" src="pages/empress/js/tree.js"></script>
</head>

<body>
  <!-- The tree -->
  <div class="tree-container">
    <div class="container">
      <canvas class="tree-surface" , id="tree-surface">
        Your browser does not support HTML5
      </canvas>
      <div id="divcontainer"></div>
      <div class="square"></div>
      <div class="selected-tree-menu">
        <input id="collapse" type="button" value="collapse" onclick="selectedTreeCollapse()" />
      </div>
    </div>

    <div class="metadata-tabs">
      <!-- File Upload tab -->
      <button class="collapsible">Upload Newick File</button>
      <div class="content">
        <input type="file" id="tree_file"><br>
      </div>
      <!-- Branch tab -->
      <button class="collapsible">Branches</button>
      <div class="content">
        <div>
          <label for="highlight-options">Color by...</label>
          <select id="highlight-options">
            <option value=0 disabled> -- select an option -- </option>
          </select>
        </div>
        <div>
          <label for="color-options">Choose Color Map</label>
          <select id="color-options">
            <option disabled> -- Sequential -- </option>
            <option value="viridis" color="red">viridis</option>
            <option value="Blues">Blue</option>
            <option value="Greens">Green</option>
            <option value="Reds">Red</option>
            <option value="BuGn">Blue to Green</option>
            <option value="cool">Blue to Purple</option>
            <option value="YlOrRd">Yellow to Red</option>
            <option value="hot">Hot</option>
            <option value="winter">Winter</option>
            <option disabled>-- Diverging --</option>
            <option value="seismic">Blue to Red</option>
            <option value=coolwarm>Cool to Warm</option>
            <option value="PRGn">Purple to Green</option>
          </select>
        </div>
        <div>
          <button onclick="userHighlightSelect()">Color Branches</button>
        </div>
      </div>

      <!-- Color Clades -->
      <button class="collapsible">Color Clades</button>
      <div class="content">
        <div>
          <label for="tax-level">Taxonomic Level...</label>
          <select id="tax-level">
            <option value=0 disabled> -- select an option -- </option>
            <option>Kindom</option>
            <option>Phylum</option>
            <option>Class</option>
            <option>Order</option>
            <option>Family</option>
            <option>Genus</option>
            <option>Species</option>
          </select>
        </div>
        <div>
          <label for="clade-options">Color by...</label>
          <select id="clade-options">
            <option value=0 disabled> -- select an option -- </option>
            <option value=0>Default</option>
          </select>
        </div>
        <div>
          <label for="color-options-tax">Choose Color Map</label>
          <select id="color-options-tax">
            <option disabled> -- Sequential -- </option>
            <option value="viridis" color="red">viridis</option>
            <option value="Blues">Blue</option>
            <option value="Greens">Green</option>
            <option value="Reds">Red</option>
            <option value="BuGn">Blue to Green</option>
            <option value="cool">Blue to Purple</option>
            <option value="YlOrRd">Yellow to Red</option>
            <option value="hot">Hot</option>
            <option value="winter">Winter</option>
            <option disabled>-- Diverging --</option>
            <option value="seismic">Blue to Red</option>
            <option value=coolwarm>Cool to Warm</option>
            <option value="PRGn">Purple to Green</option>
          </select>
        </div>
        <div>
          <button onclick="userCladeColor()">Color Clades</button>
        </div>
      </div>
      <!-- Collapse -->
      <button class="collapsible">Auto-Collapse</button>
      <div class="content">
        <div>
          <label for="zcollapse-level">Collapse BY...</label>
          <select id="collapse-level">
            <option value=0 disabled> -- select an option -- </option>
            <option>Kindom</option>
            <option>Phylum</option>
            <option>Class</option>
            <option>Order</option>
            <option>Family</option>
            <option>Genus</option>
            <option>Species</option>
          </select>
        </div>
        <div>
          <label for="color-options-tax">Choose Color Map</label>
          <select id="color-options-collapse">
            <option disabled> -- Sequential -- </option>
            <option value="viridis" color="red">viridis</option>
            <option value="Blues">Blue</option>
            <option value="Greens">Green</option>
            <option value="Reds">Red</option>
            <option value="BuGn">Blue to Green</option>
            <option value="cool">Blue to Purple</option>
            <option value="YlOrRd">Yellow to Red</option>
            <option value="hot">Hot</option>
            <option value="winter">Winter</option>
            <option disabled>-- Diverging --</option>
            <option value="seismic">Blue to Red</option>
            <option value=coolwarm>Cool to Warm</option>
            <option value="PRGn">Purple to Green</option>
          </select>
        </div>
        <div>
          <label for="collapse-options">Color by...</label>
          <select id="collapse-options">
            <option value=0 disabled> -- select an option -- </option>
          </select>
        </div>
        <div>
          <button onclick="autoCollapseTree()">Collapse Tree</button>
        </div>
      </div>

      <button class="collapsible">Quick Find</button>
      <div class="content">
      </div>
  </div>

  <script type="text/javascript">
    var coll = document.getElementsByClassName("collapsible");
    var i;
    for (i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.display === "block") {
          content.style.display = "none";
        } else {
          content.style.display = "block";
        }

        var allCollapsed = true;
        var menuItems = document.getElementsByClassName("content");
        var i;
        for(i = 0; i < menuItems.length; i++) {
          if(menuItems[i].style.display === "block") {
            allCollapsed = false;
          }
        }
        if(allCollapsed) {
          document.querySelector('.metadata-tabs').style.opacity = "0.5";
        }
        else {
          document.querySelector('.metadata-tabs').style.opacity = "1.0";
        }
      });
    }
  </script>

  <div class="metadata-container">
    <div id="scrolltable">
    </div>
  </div>

    <script type="text/javascript">
      // fields to extract from metadata, used in extractInfo()
      let field = {
        edgeFields: ["px", "py", "branch_color", "x", "y",
          "branch_color"
        ],
        nodeFields: ["x", "y", "color"],
        triangleFields: ["cx", "cy", "color", "lx", "ly", "color", "rx", "ry", "color"]
      };

      // stores matrices, and buffers that webgl will uses
      let shaderProgram = {};
      let c_shaderProgram = {};

      // the complied vertex/fragment shaders
      let gl = {}; // webgl context - used to call webgl functions

      // stores info need to draw such as vertex data
      let drawingData = {
        isMouseDown: false,
        lastMouseX: null,
        lastMouseY: null,
        zoomAmount: 10,
        currentZoom: 0,
        maxZoom: 30,
        coloredClades: [],
        selectTree: [],
        triangles: [],
        numBranches: 0
      };

      let numAttr = 0;
      let attrItem = {};
      let grid = {};
      let labels = {};
      let labelPos = 0;
      let gridInfo = {
        initData: [],
        data: [],
        columns: [],
        options: {},
        grid: {}
      };
      const TRI_PER_ARC = 100;
      const ELEMENTS_PER_VERT = 5;
      const VERT_PER_TRI = 3;


      let numUserSelects = 0;
      const CLEAR_COLOR_HEX = "FFFFFF";
      const CLEAR_COLOR = 1;
      let camera = {};
      let shftPress = false;
      let tree = {};
    </script>

    <script type="text/javascript">
      {
        buildTree();
        initialize();
      }
    </script>

</body>

</html>
